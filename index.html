<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>äººç‹¼GMæ”¯æ´ãƒ„ãƒ¼ãƒ«ï¼ˆæœ€æ–°ç‰ˆ å®Œå…¨çµ±åˆç‰ˆï¼‰</title>
<style>
body { font-family:"Yu Gothic UI",sans-serif; text-align:center; padding:20px; transition: background 0.5s,color 0.5s;}
h1{margin-bottom:10px;}
#timer{font-size:48px;margin:10px;}
button{margin:5px;padding:10px 20px;font-size:16px;border:none;border-radius:8px;background:#4CAF50;color:white;cursor:pointer;}
button:hover{background:#45a049;}
textarea{width:80%;height:100px;margin-top:10px;padding:10px;font-size:15px;border-radius:6px;border:1px solid #ccc;}
select,input{padding:6px;margin:3px;font-size:16px;border-radius:6px;border:1px solid #ccc;}
#player-settings,#timer-settings,#logContainer,#actionContainer{background:#fff;border-radius:10px;padding:10px;margin:20px auto;width:70%;box-shadow:0 0 5px rgba(0,0,0,0.1);text-align:left;}
#modal,#seerModal,#mediumModal,#actionModal,#helpModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;justify-content:center;align-items:center;z-index:1000;}
#modal{background:rgba(0,0,0,0.8);}
#modalContent,#seerContent,#mediumContent,#actionContent,#helpContent{background:#222;color:#fff;padding:20px;border-radius:10px;width:70%;text-align:center;box-shadow:0 0 20px rgba(0,0,0,0.5);}
#seerResult,#mediumResult{font-size:36px;font-weight:bold;margin-top:20px;}
</style>
</head>
<body>

<h1>äººç‹¼GMæ”¯æ´ãƒ„ãƒ¼ãƒ«</h1>

<button onclick="showHelpModal()">â“ ä½¿ã„æ–¹</button>
<h2 id="turnLabel">ç¾åœ¨ã®ã‚¿ãƒ¼ãƒ³: æ˜¼</h2>
<div id="timer">10:00</div>
<button onclick="startTimer()">â–¶ ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹</button>
<button onclick="nextTurn()">ğŸŒ™ æ¬¡ã®ã‚¿ãƒ¼ãƒ³ã¸</button>
<button onclick="showNightModal()">ğŸŒ™ å¤œã®åŸç¨¿</button>
<button onclick="showSeerModal()">ğŸ”® å ã„å¸«å°‚ç”¨ç”»é¢</button>
<button onclick="showMediumModal()">ğŸ’€ éœŠåª’å¸«å°‚ç”¨ç”»é¢</button>
<button onclick="showActionModal()">ğŸ“ å¤œã®è¡Œå‹•ä¸€è¦§</button>

<hr>

<div id="player-settings">
<h3>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¨­å®š</h3>
<label>äººç‹¼: <input type="text" id="player_wolf" placeholder="åå‰"></label><br>
<label>å ã„å¸«: <input type="text" id="player_seer" placeholder="åå‰"></label><br>
<label>ç‹‚äºº: <input type="text" id="player_mad" placeholder="åå‰"></label><br>
<label>éœŠåª’å¸«: <input type="text" id="player_medium" placeholder="åå‰"></label><br>
<label>ç‹©äºº: <input type="text" id="player_hunter" placeholder="åå‰"></label><br>
<label>æ‹äºº: <input type="text" id="player_lover" placeholder="åå‰"></label><br>
<button onclick="updatePlayerNames()">ğŸ’¾ ä¿å­˜</button>
</div>

<div id="timer-settings">
<h3>ã‚¿ã‚¤ãƒãƒ¼è¨­å®šï¼ˆåˆ†ï¼‰</h3>
<label>æ˜¼: <input type="number" id="day_time" min="1" value="10"></label><br>
<label>å¤œ: <input type="number" id="night_time" min="1" value="3"></label><br>
<button onclick="saveTimerSettings()">ğŸ’¾ ä¿å­˜</button>
</div>

<hr>

<h3>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¸æŠ</h3>
<select id="actionSelect" onchange="updateScript()">
  <option value="default">å…¨ä½“åŸç¨¿</option>
  <option value="å ã„">å ã„å¸«ç”¨ï¼ˆå¤œï¼‰</option>
  <option value="è¥²æ’ƒ">äººç‹¼ç”¨ï¼ˆå¤œï¼‰</option>
  <option value="éœŠåª’">éœŠåª’å¸«ç”¨ï¼ˆå¤œï¼‰</option>
  <option value="ç‹©äºº">ç‹©äººç”¨ï¼ˆå¤œï¼‰</option>
</select>

<h3>åŸç¨¿</h3>
<textarea id="scriptArea"></textarea><br>
<button onclick="saveScript()">ğŸ’¾ ä¿å­˜</button>

<div id="logContainer">
<h3>å¤œã®ãƒ­ã‚°</h3>
<div id="logArea" style="height:150px; overflow-y:auto; background:#f5f5f5; padding:10px; border-radius:6px;"></div>
<button onclick="exportLogs()">ğŸ“„ ãƒ­ã‚°ã‚’ä¿å­˜</button>
</div>

<!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="modal"><div id="modalContent"><h2>å¤œã®åŸç¨¿</h2><p id="modalScript"></p><button onclick="closeModal()">é–‰ã˜ã‚‹</button></div></div>

<div id="seerModal"><div id="seerContent">
<h2>å ã„å¸«å°‚ç”¨</h2>
<label>å ã†äºº: <select id="seerTarget"></select></label><br><br>
<button onclick="showSeerResult('å¸‚æ°‘é™£å–¶')">å¸‚æ°‘é™£å–¶</button>
<button onclick="showSeerResult('äººç‹¼é™£å–¶')">äººç‹¼é™£å–¶</button>
<p id="seerResult"></p>
<button onclick="closeSeerModal()">é–‰ã˜ã‚‹</button>
</div></div>

<div id="mediumModal"><div id="mediumContent">
<h2>éœŠåª’å¸«å°‚ç”¨</h2>
<label>å‡¦åˆ‘è€…: <select id="mediumTarget"></select></label><br><br>
<button onclick="showMediumResult('å¸‚æ°‘é™£å–¶')">å¸‚æ°‘é™£å–¶</button>
<button onclick="showMediumResult('äººç‹¼é™£å–¶')">äººç‹¼é™£å–¶</button>
<p id="mediumResult"></p>
<button onclick="closeMediumModal()">é–‰ã˜ã‚‹</button>
</div></div>

<div id="actionModal"><div id="actionContent">
<h2>å¤œã®è¡Œå‹•ä¸€è¦§</h2>
<div id="actionList" style="text-align:left; max-height:300px; overflow-y:auto;"></div>
<button onclick="closeActionModal()">é–‰ã˜ã‚‹</button>
</div></div>

<div id="helpModal"><div id="helpContent">
<h2>ä½¿ã„æ–¹</h2>
<ul style="text-align:left;">
  <li>å½¹è·ã®åå‰ã‚’ç™»éŒ²ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚</li>
  <li>æ˜¼å¤œã®æ™‚é–“è¨­å®šã‚’å¤‰æ›´ã§ãã¾ã™ã€‚</li>
  <li>åŸç¨¿ã‚’ç·¨é›†ã—ã€èª­ã¿ä¸Šã’å¯èƒ½ã§ã™ã€‚</li>
  <li>å ã„å¸«ãƒ»éœŠåª’å¸«å°‚ç”¨ç”»é¢ã¯GMãŒæ“ä½œã€‚</li>
  <li>ãƒ­ã‚°ã‚’TXTã§ä¿å­˜ã€ãƒ†ãƒ³ãƒ—ãƒ¬ã‚‚è¤‡æ•°ä¿å­˜å¯ã€‚</li>
</ul>
<button onclick="closeHelpModal()">é–‰ã˜ã‚‹</button>
</div></div>

<script>
let turns={æ˜¼:600,å¤œ:180};
let players={äººç‹¼:'',å ã„å¸«:'',ç‹‚äºº:'',éœŠåª’å¸«:'',ç‹©äºº:'',æ‹äºº:''};
let scripts={
  æ˜¼:{default:'çš†ã•ã‚“ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚æ˜¼ãŒå§‹ã¾ã‚Šã¾ã—ãŸã€‚'},
  å¤œ:{
    default:'çš†ã•ã‚“å¤œãŒè¨ªã‚Œã¾ã—ãŸã€‚ä¼ã›ã¦ãã ã•ã„ã€‚',
    å ã„:'å ã„å¸«ã•ã‚“å ã„å¸«ã•ã‚“ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚å ã„ãŸã„äººã‚’1äººé¸ã‚“ã§ãã ã•ã„ã€‚',
    è¥²æ’ƒ:'äººç‹¼ã•ã‚“äººç‹¼ã•ã‚“ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚æ®ºã—ãŸã„äººã‚’1äººé¸ã‚“ã§ãã ã•ã„ã€‚',
    éœŠåª’:'éœŠåª’å¸«ã•ã‚“éœŠåª’å¸«ã•ã‚“ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚ãŠæ˜¼ã®ã‚¿ãƒ¼ãƒ³ã«ã¤ã‚‰ã‚ŒãŸæ–¹ã®æ­£ä½“ã‚’æ•™ãˆã¾ã™ã€‚',
    ç‹©äºº:'ç‹©äººã•ã‚“ç‹©äººã•ã‚“ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚å®ˆã‚ŠãŸã„äººã‚’1äººé¸ã‚“ã§ãã ã•ã„ã€‚åŒã˜äººã‚’é€£ç¶šã§é¸ã¶ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚'
  }
};

let currentTurn='æ˜¼', remainingTime=turns[currentTurn], timerInterval=null;
let nightLogs=[], nightActions={};

function formatTime(sec){let m=Math.floor(sec/60),s=sec%60;return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;}
function startTimer(){if(timerInterval)return;timerInterval=setInterval(()=>{if(remainingTime<=0){clearInterval(timerInterval);timerInterval=null;alert(`${currentTurn}ã®æ™‚é–“ãŒçµ‚äº†ã—ã¾ã—ãŸï¼`);}else{remainingTime--;document.getElementById('timer').textContent=formatTime(remainingTime);}},1000);}
function nextTurn(){if(timerInterval){clearInterval(timerInterval);timerInterval=null;}currentTurn=(currentTurn==='æ˜¼')?'å¤œ':'æ˜¼';remainingTime=turns[currentTurn];document.getElementById('turnLabel').textContent=`ç¾åœ¨ã®ã‚¿ãƒ¼ãƒ³: ${currentTurn}`;document.getElementById('timer').textContent=formatTime(remainingTime);document.body.style.backgroundColor=(currentTurn==='æ˜¼')?'#fff':'#111';document.body.style.color=(currentTurn==='æ˜¼')?'#000':'#eee';updateScript();}

function updatePlayerNames(){for(let k in players){players[k]=document.getElementById(`player_${roleToId(k)}`).value||k;}updateScript();alert('ä¿å­˜ã—ã¾ã—ãŸï¼');}
function roleToId(r){return {'äººç‹¼':'wolf','å ã„å¸«':'seer','ç‹‚äºº':'mad','éœŠåª’å¸«':'medium','ç‹©äºº':'hunter','æ‹äºº':'lover'}[r];}

function updateScript(){let a=document.getElementById('actionSelect').value;if(currentTurn==='æ˜¼')a='default';document.getElementById('scriptArea').value=scripts[currentTurn][a];}
function saveScript(){let a=document.getElementById('actionSelect').value;if(currentTurn==='æ˜¼')a='default';scripts[currentTurn][a]=document.getElementById('scriptArea').value;alert('åŸç¨¿ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');}
function saveTimerSettings(){turns['æ˜¼']=parseInt(document.getElementById('day_time').value)*60;turns['å¤œ']=parseInt(document.getElementById('night_time').value)*60;alert('æ™‚é–“ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');}

// ãƒ¢ãƒ¼ãƒ€ãƒ«ãªã©ã®å‡¦ç†ã¯å‰å›ç‰ˆã¨åŒã˜
function showNightModal(){document.getElementById('modalScript').innerText=scripts['å¤œ']['default'];document.getElementById('modal').style.display='flex';}
function closeModal(){document.getElementById('modal').style.display='none';}

function showSeerModal(){hideMainUI(true);const s=document.getElementById('seerTarget');s.innerHTML='';for(let p in players){if(p!=='å ã„å¸«'){s.innerHTML+=`<option value="${p}">${players[p]}</option>`;}}document.getElementById('seerResult').innerText='';document.getElementById('seerModal').style.display='flex';}
function closeSeerModal(){document.getElementById('seerModal').style.display='none';hideMainUI(false);}

function showMediumModal(){hideMainUI(true);const s=document.getElementById('mediumTarget');s.innerHTML='';for(let p in players){s.innerHTML+=`<option value="${p}">${players[p]}</option>`;}document.getElementById('mediumResult').innerText='';document.getElementById('mediumModal').style.display='flex';}
function closeMediumModal(){document.getElementById('mediumModal').style.display='none';hideMainUI(false);}

function showSeerResult(f){const p=document.getElementById('seerTarget').value;document.getElementById('seerResult').innerText=`${players[p]}: ${f}`;nightLogs.push(`å ã„å¸«ãŒ${players[p]}ã‚’å ã£ãŸ â†’ ${f}`);nightActions['å ã„å¸«']=`å ã„å¸«: ${players[p]} â†’ ${f}`;updateLogDisplay();}
function showMediumResult(f){const p=document.getElementById('mediumTarget').value;document.getElementById('mediumResult').innerText=`${players[p]}: ${f}`;nightLogs.push(`éœŠåª’å¸«ãŒ${players[p]}ã‚’ç¢ºèª â†’ ${f}`);nightActions['éœŠåª’å¸«']=`éœŠåª’å¸«: ${players[p]} â†’ ${f}`;updateLogDisplay();}

function showActionModal(){const d=document.getElementById('actionList');d.innerHTML=Object.values(nightActions).join('<br>')||'ã¾ã è¡Œå‹•ãŒã‚ã‚Šã¾ã›ã‚“';document.getElementById('actionModal').style.display='flex';}
function closeActionModal(){document.getElementById('actionModal').style.display='none';}
function showHelpModal(){document.getElementById('helpModal').style.display='flex';}
function closeHelpModal(){document.getElementById('helpModal').style.display='none';}

function hideMainUI(h){document.getElementById('player-settings').style.display=h?'none':'block';document.getElementById('timer-settings').style.display=h?'none':'block';document.getElementById('logContainer').style.display=h?'none':'block';document.getElementById('actionSelect').style.display=h?'none':'inline-block';document.getElementById('scriptArea').style.display=h?'none':'inline-block';}

function updateLogDisplay(){document.getElementById('logArea').innerHTML=nightLogs.join('<br>');}
function exportLogs(){const logText=nightLogs.join("\n")||"ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“ã€‚";const blob=new Blob([logText],{type:"text/plain"});const url=URL.createObjectURL(blob);const a=document.createElement("a");a.href=url;const now=new Date();const ts=`${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()}_${now.getHours()}-${now.getMinutes()}`;a.download=`jinro_log_${ts}.txt`;a.click();URL.revokeObjectURL(url);}

window.onload=function(){updateScript();document.getElementById('timer').textContent=formatTime(remainingTime);document.body.style.backgroundColor='#fff';};
</script>
</body>
</html>
